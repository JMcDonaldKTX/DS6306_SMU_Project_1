---
title: "Presentation 1"
author: "Ranjan Karki & Jason McDonald"
date: "12/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Exploratory Data Analysis of Breweries and Beer 
## Prepared for Brendan Whitworth, CEO, and Fernando Tennenbaum, CFO, of Anheuser Busch InBev  
Mr. Whitworth, Mr. Tennenbaum, thank you for the opportunity to work with Anheuser Busch InBev to analyze data on a set of craft beers and the breweries that make them.  We've received the datasets containing information on over 2400 craft beers made by over 550 breweries.   

We've begun to explore these datasets with the intention of answering the questions you previously provided.  I believe we've been able to extract insights that you will find valuable to Anheuser Busch InBev.    

With that, if you are ready, let's walk through our initial findings within the data.  


## Question 1: How many breweries are present in each state?
### To approach this question, we were able to read in the data contained in the list of Breweries and count the number in each state.
```{r "Question 1", message = FALSE, warning = FALSE}
library(dplyr)
library(ggplot2)
library(tidyr)
#Read in Breweries.csv and setup a list with the state and count of each state, then build a barplot
Breweries <- read.csv("Breweries.csv", header = TRUE , ",")
totals <- Breweries %>% count (State)
q1 <- ggplot(data=totals, aes(x = State,y=n, fill = n, width = 0.8)) + geom_bar(stat='identity') + scale_fill_gradient2(midpoint=mean(totals$n), low= '#971B1E', mid = '#E02124', high = '#FFF200', space='#E1E1E1') + geom_text(aes(x= State,n +1, label = n), data = totals)+ ggtitle("Total Breweries in each State") + coord_flip() + theme(legend.title = element_text(colour='#331D0C')) + labs(fill="Count of Breweries", y = "Count of Breweries")
```

### The below barplot displays the count of breweries per state. 
```{r "Question 1 Result", message = FALSE, warning = FALSE, fig.dim = c(5,7)}
q1
```

###Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  (RMD only, this does not need to be included in the presentation or the deck.)

```{r "Question 2", message = FALSE, warning = FALSE}
Beers <- read.csv("Beers.csv", header = TRUE , ",")
BeerN <- rename(Beers,"Brew_ID" = "Brewery_id")
tdf <- merge(BeerN,Breweries, by = "Brew_ID", na.rm = True)

#View(tdf)
head(tdf,n=6)
tail (tdf,n=6)

###EXTRA
top_n(tdf,6,Brew_ID)

```

###.   Address the missing values in each column
```{r "Question 3", message = FALSE, warning = FALSE}

colSums(is.na(tdf))


library(tidyr)  
### assigning to new data frame 
dtdf <- tdf[!is.na(tdf$ABV), ]
dtdf <- tdf[!is.na(tdf$IBU), ]

colSums(is.na(dtdf))



```

###4.Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

```{r "Question 4", message = FALSE, warning = FALSE}

df1<- dtdf %>% group_by(State) %>% summarise(Median_ABV = median(ABV)) 
ggplot(data = df1, aes(x= State, y = Median_ABV ,fill = State))+geom_bar(stat='identity') + ggtitle ("State v.Median_ABV")
## question how can I do both at the same time 





df2<- dtdf %>% group_by(State) %>% summarise(Median_IBU = median(IBU)) 
ggplot(data = df2, aes(x= State, y = Median_IBU ,fill = State))+geom_bar(stat='identity')+ ggtitle ("State v.Median_IBU")

```

###5.Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer? 

```{r "Question 5", message = FALSE, warning = FALSE}
#row number with of max value can be obtained by which.max, to get all information using by subsetting data frame. 

df1[which.max(df1$Median_ABV),] ###Maine


df2[which.max(df2$Median_IBU),]  ###Maine

```

###6.Comment on the summary statistics and distribution of the ABV variable.
```{r "Question 6", message = FALSE, warning = FALSE}
summary(df1)

sd(df1$Median_ABV)   ###0.005437061
mean(df1$Median_ABV)  ### 0.05564

hist(df1$Median_ABV,col ="red", main = "Histogram of ABV")


```

##7.   Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.  Make your best judgment of a relationship and EXPLAIN your answer.
```{r "Question 7", message = FALSE, warning = FALSE}

df3 <- merge(df1,df2, by = "State")
 df3 %>% ggplot(aes(x=Median_ABV,y= Median_IBU,fill = State))+geom_point()+geom_smooth (formula = y~ x,method="lm")+ggtitle(("ABV vs IBU"))
```

